![bin2cpp logo](http://www.end2endzone.com/wp-content/uploads/2015/01/bin2cpp-featured-image.png)

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Github Releases](https://img.shields.io/github/release/end2endzone/bin2cpp.svg)](https://github.com/end2endzone/bin2cpp/releases)
[![Build status](https://ci.appveyor.com/api/projects/status/q9k0ebb971o475qi/branch/master?svg=true)](https://ci.appveyor.com/project/end2endzone/bin2cpp/branch/master)
[![Tests status](https://img.shields.io/appveyor/tests/end2endzone/bin2cpp/master.svg)](https://ci.appveyor.com/project/end2endzone/bin2cpp/branch/master/tests)

AppVeyor build statistics:

[![Build statistics](https://buildstats.info/appveyor/chart/end2endzone/bin2cpp)](https://ci.appveyor.com/project/end2endzone/bin2cpp/branch/master)



# bin2cpp

bin2cpp is a command line tool for embedding small files (like images, icons or raw data files) into a C++ executable.

It's main features are:

*   Easily converts small files as C++ source code for embedding into a C++ executable.
*   Content extraction supported by a unique function call for each embedded file.
*   Supports a multiple embedded files at once.
*   Makes it harder for resource hacker to modify or steal the embedded files.
*   No third party libraries required for retrieving the data of the embedded files.

bin2cpp is not implemented using [executable resources](http://en.wikipedia.org/wiki/Resource_(Windows)). Instead, bin2cpp creates multiple function calls for retrieving the data which makes it harder to steal the executable's content. It also makes it even harder to replace an existing resource of the executable.

It is designed to be easy to use by developers and to provide easy call functions to get access to the data of the embedded files.

The generated functions that reads and extracts the embedded content does not rely on external libraries so you don't need to setup your projects to use any third party library to start using bin2cpp. All your embedded data can be accessed right away.

# Command Line Usage

**Usage:** bin2cpp [input file] [output folder] [header filename] [function identifier] [chunk size] [-override].

| Argument            | Description                                                                                    |
|---------------------|------------------------------------------------------------------------------------------------|
| input file          | Path to the target file to embed in a C++ source code.                                         |
| output folder       | Output path to create generated source code. ie: .\generated_files\                            |
| header filename     | File name of the C++ Header file. ie: SplashScreen.h                                           |
| function identifier | Identifier of the function name that is used to get an instance of the file. ie: SplashScreen  |
| chunk size          | Size of each string segments. Defaults to 200]                                                 |
| override            | Tells bin2cpp to over write the destination files.                                             |


# Example

### Input File:
html5skeleton.html
```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
  <title>Hello World!</title>
</head>
<body>
Hello World!
</body>
</html>
```

### Command:
```batchfile
bin2cpp.exe html5skeleton.html .\outdir resourcehtml5skeleton.h HtmlSample 50 -override
```

### Console output

```batchfile
bin2cpp v1.4
Copyright (C) 2013-2017 end2endzone.com. All rights reserved.
Embedding "html5skeleton.html" into "resourcehtml5skeleton.h" using chunks of 50 bytes overriding existing files...
Done.
```

### File resourcehtml5skeleton.h

```cpp
/**
 * This file was generated by bin2cpp v1.4.
 * Copyright (C) 2013-2017 end2endzone.com. All rights reserved.
 * Do not modify this file.
 */
#pragma once
#include <stddef.h>
namespace bin2cpp
{
  #ifndef BIN2CPP_EMBEDEDFILE_CLASS
  #define BIN2CPP_EMBEDEDFILE_CLASS
  class File
  {
  public:
    virtual size_t getSize() const = 0;
    virtual size_t getSegmentSize() const = 0;
    virtual size_t getNumSegments() const = 0;
    virtual const char * getFilename() const = 0;
    virtual const char * getSegment(size_t iIndex, size_t & oLength) const = 0;
    virtual const char * getMd5() const = 0;
    virtual char * newBuffer() const = 0;
    virtual bool save(const char * iFilename) const = 0;
  };
  #endif
  const File & getHtmlSampleFile();
}; //bin2cpp
```

### File resourcehtml5skeleton.cpp

```cpp
/**
 * This file was generated by bin2cpp v1.4.
 * Copyright (C) 2013-2017 end2endzone.com. All rights reserved.
 * Do not modify this file.
 */
#include "resourcehtml5skeleton.h"
#include <stdio.h> //for FILE
#include <string> //for memcpy
namespace bin2cpp
{
  class HtmlSampleFile : public virtual bin2cpp::File
  {
  public:
    HtmlSampleFile() {}
    ~HtmlSampleFile() {}
    virtual size_t getSize() const { return 238; }
    virtual size_t getSegmentSize() const { return 50; }
    virtual size_t getNumSegments() const { return 5; }
    virtual const char * getFilename() const { return "html5skeleton.html"; }
    virtual const char * getSegment(size_t iIndex, size_t & oLength) const
    {
      oLength = 0;
      if (iIndex >= getNumSegments())
        return NULL;
      const char * buffer = NULL;
      size_t index = 0;
      oLength = getSegmentSize();
      buffer = "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta"; if (iIndex == index) return buffer; index++;
      buffer = " charset=\"utf-8\">\r\n  <meta name=\"viewport\" content"; if (iIndex == index) return buffer; index++;
      buffer = "=\"width=device-width, initial-scale=1, user-scalab"; if (iIndex == index) return buffer; index++;
      buffer = "le=yes\">\r\n  <title>Hello World!</title>\r\n</head>\r\n"; if (iIndex == index) return buffer; index++;
      oLength = 38;
      buffer = "<body>\r\nHello World!\r\n</body>\r\n</html>"; if (iIndex == index) return buffer; index++;
      oLength = 0;
      return NULL;
    }
    virtual const char * getMd5() const { return "85f80d7db80c1a4392dc32ecb429a8a9"; }
    virtual char * newBuffer() const
    {
      size_t size = getSize();
      char * buffer = new char[size];
      if (buffer == NULL)
        return NULL;
      size_t numSegments = getNumSegments();
      size_t segmentLength = 0;
      size_t index = 0;
      for(size_t i=0; i<numSegments; i++)
      {
        const char * segmentBuffer = getSegment(i, segmentLength);
        memcpy(&buffer[index], segmentBuffer, segmentLength);
        index += segmentLength;
      }
      return buffer;
    }
    virtual bool save(const char * iFilename) const
    {
      FILE * f = fopen(iFilename, "wb");
      if (!f) return false;
      size_t numSegments = getNumSegments();
      size_t segmentLength = 0;
      const char * buffer = NULL;
      for(size_t i=0; i<numSegments; i++)
      {
        buffer = getSegment(i, segmentLength);
        fwrite(buffer, 1, segmentLength, f);
      }
      fclose(f);
      return true;
    }
  };
  const File & getHtmlSampleFile() { static HtmlSampleFile _instance; return _instance; }
}; //bin2cpp
```

### Code sample
```cpp
#include <stdio.h>
#include <string>
#include "base64.h"
#include "resourcehtml5skeleton.h" //a single include file is all you need

int main(int argc, char* argv[])
{
  //get a reference to the embedded file
  const bin2cpp::File & resource = bin2cpp::getHtmlSampleFile();

  //print information about the file.
  printf("Embedded file '%s' is %d bytes long.\n", resource.getFilename(), resource.getSize());
  printf("The MD5 of the file is %s.\n", resource.getMd5());

  //Saving content back to a file.
  printf("Saving embedded file to 'html5skeleton_copy.html'...\n");
  bool saved = resource.save("html5skeleton_copy.html");
  if (saved)
    printf("saved\n");
  else
    printf("failed\n");

  //encoding content as base64
  char * buffer = resource.newBuffer(); //returns a new buffer with a copy of the file. Ownership is transfered to the local function
  size_t bufferSize = resource.getSize();
  std::string encodedFile = toBase64(buffer, bufferSize); //binary to base64 encoder
  delete buffer; //delete allocatd buffer from newBuffer()
  buffer = NULL;

  //do something with the base64 encoded file
  //...

  return 0;
}
```

# Installing

Please refer to file [INSTALL.md](INSTALL.md) for details on how installing/building the application.

## Testing
bin2cpp comes with unit tests which tests for multiple combinations to make sure that input files are always encoded without errors.

Test are build using the Google Test v1.6.0 framework. For more information on how googletest is working, see the [google test documentation primer](https://github.com/google/googletest/blob/release-1.8.0/googletest/docs/V1_6_Primer.md).  

Test are automatically build when building the solution. Please see the '*build step*' section for details on how to build the software.

Test can be executed from the following two locations:

1) From the Visual Studio IDE:
   1) Select the project '*bin2cpp_unittest*' as StartUp project.
   2) Hit CTRL+F5 (Start Without Debugging)
2) From the output binaries folder:
   1) Open a file navigator and browse to the output folder(for example c:\projects\bin2cpp\msvc\Win32\Release)
   2) Run the '*generate_test_files.bat*' batch script. The script will generate all required input files.
   3) Run the '*bin2cpp_unittest.exe*'

See also the latest test results at the beginning of the document.

# Screenshots

bin2cpp v1.3 Sample[![bin2cpp v1.3 Sample](http://www.end2endzone.com/wp-content/uploads/2015/01/bin2cpp-v1.3-done.png)](http://www.end2endzone.com/wp-content/uploads/2015/01/bin2cpp-v1.3-done.png)

bin2cpp v1.3 Usage
[![bin2cpp v1.3 Usage](http://www.end2endzone.com/wp-content/uploads/2015/01/bin2cpp-v1.3-usage.png)](http://www.end2endzone.com/wp-content/uploads/2015/01/bin2cpp-v1.3-usage.png)

# Compatible with

bin2cpp is only available for the Windows platform and has been tested with the following version of Windows:

*   Windows XP
*   Windows Vista
*   Windows 7
  
# Versioning

We use [Semantic Versioning 2.0.0](http://semver.org/) for versioning. For the versions available, see the [tags on this repository](https://github.com/end2endzone/bin2cpp/tags).

# Authors

* **Antoine Beauchamp** - *Initial work* - [end2endzone](https://github.com/end2endzone)

See also the list of [contributors](https://github.com/end2endzone/bin2cpp/blob/master/AUTHORS) who participated in this project.

# License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details
